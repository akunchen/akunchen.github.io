!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.CLICK="click",e.HOLD="hold",e.HOLD_MOVE="hold_MOVE"}(t.TouchButtonTypeEnum||(t.TouchButtonTypeEnum={})),function(e){e.ARC="arc",e.LIGHTNING="lightning"}(t.TouchButtonSubTypeEnum||(t.TouchButtonSubTypeEnum={})),function(e){e.GOOD="good",e.PERFECT="perfect",e.MISS="miss"}(t.TouchButtonResultEventEnum||(t.TouchButtonResultEventEnum={}))},function(e,t,n){e.exports=n(13)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCALE_PERCENT_PERFECT=.3,t.SCALE_OFFSET=.1,t.SCALE_INTERVAL=100,t.ANIMATE_AREA_MAX=1.7,t.ANIMATE_AREA_MIN=.6,t.COMBO_TIMES_BUILD_DOUBLE=4,t.DOUBLE_TIME_LAST_SECOND=1e4,t.TRIPLE_TIME_LAST_SECOND=1e4},function(e,t){var n,o,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,l=[],c=!1,h=-1;function p(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&d())}function d(){if(!c){var e=a(p);c=!0;for(var t=l.length;t;){for(u=l,l=[];++h<t;)u&&u[h].run();h=-1,t=l.length}u=null,c=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||c||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),window.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e,null,4))},(new(n(11).default)).run()},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function s(e){try{u(o.next(e))}catch(e){r(e)}}function a(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),s=function(){function e(){this.stageWidth=750,this.stageHeight=1334}return e.prototype.loadResources=function(){var e=["res/atlas/game.atlas"].map(function(e){return new Promise(function(t){return Laya.loader.load(e,Laya.Handler.create(null,t))})});return Promise.all(e)},e.prototype.initStage=function(){Laya.Config.isAntialias=!0,Laya.init(this.stageWidth,this.stageHeight,Laya.WebGL),Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_CENTER,Laya.stage.scaleMode=Laya.Stage.SCALE_FIXED_WIDTH,Laya.stage.bgColor="#323a42"},e.prototype.run=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return this.initStage(),[4,this.loadResources()];case 1:return t.sent(),e=new r.default,Laya.stage.addChild(e),[2]}})})},e}();t.default=s},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(19),a=n(20),u=n(21),l=n(22),c=Laya.SoundManager,h=n(27),p=Laya.Sprite,d="game_over",f=function(e){function t(){var t=e.call(this)||this;t.score=0,t.combo=0,t.ep=new r.EventProxy,t.songNameTextIndex=0,t.bgImage.y=0,t.addChild(new u.default(12));var n=new l.default(a.default.buttons);return t.addChild(n),n.onScoreChange(function(e,n){t.score=e,t.scores.text=t.score.toString(),t.combo=n,t.toggleCombo()}),c.playMusic(a.default.bgm,1,null),t.songFullName=a.default.songName,t.remainSecond=a.default.seconds,Laya.timer.loop(1e3,t,t.countDownTime),t.ep.once(d,t.gameOver.bind(t)),Laya.timer.loop(1e3,t,t.setSongName),t}return i(t,e),t.prototype.setSongName=function(){if(this.songFullName.length<=13)return this.songName.text=this.songFullName,void Laya.timer.clear(this,this.setSongName);if(this.songNameTextIndex+13<this.songFullName.length)this.songName.text=this.songFullName.substr(this.songNameTextIndex,this.songNameTextIndex+13);else{for(var e=this.songFullName.substr(this.songNameTextIndex),t=0;e.length<=13&&t<3;)e+=" ",t++;e.length<=13&&(e+=this.songFullName.substr(0,13-e.length)),this.songName.text=e}this.songNameTextIndex++},t.prototype.countDownTime=function(){this.remainTime.text=h.formatTime(this.remainSecond--),this.remainSecond<0&&(Laya.timer.clear(this,this.countDownTime),this.ep.trigger(d))},t.prototype.toggleCombo=function(){this.comboTarget.visible=this.combo>1;for(;this.comboTarget.getChildByName("child");)this.comboTarget.removeChildByName("child");for(var e=this.combo.toString(),t=0;t<e.length;t++){var n=new p;n.name="child";var o=310+50*t;n.graphics.drawTexture(Laya.loader.getRes("game/touch-combo-"+e[t]+".png"),o,25,80,80),this.comboTarget.addChild(n)}this.combo<=10?this.comboTarget.x=138:this.comboTarget.x=138-25*(e.length-10..toString().length)},t.prototype.gameOver=function(){console.log("游戏结束")},t}(s.GamePageUI);t.default=f},function(e,t,n){(function(o,i){var r,s,a,u,l;!function(o,i){e.exports;r=function(){return function(){}}.call((s={id:"eventproxy_debug",exports:{},loaded:!1}).exports,n,s.exports,s),s.loaded=!0,void 0!==r||(r=s.exports),u=[r],void 0===(l="function"==typeof(a=i)?a.apply(t,u):a)||(e.exports=l)}(0,function(e){e=e||function(){};
/*!
   * refs
   */
var t=Array.prototype.slice,n=Array.prototype.concat,r=function(){if(!(this instanceof r))return new r;this._callbacks={},this._fired={}};r.prototype.addListener=function(t,n){return e("Add listener for %s",t),this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].push(n),this},r.prototype.bind=r.prototype.addListener,r.prototype.on=r.prototype.addListener,r.prototype.subscribe=r.prototype.addListener,r.prototype.headbind=function(t,n){return e("Add listener for %s",t),this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].unshift(n),this},r.prototype.removeListener=function(t,n){var o=this._callbacks;if(t)if(n){var i=o[t];if(i)for(var r=i.length,s=0;s<r;s++)n===i[s]&&(e("Remove a listener of %s",t),i[s]=null)}else e("Remove all listeners of %s",t),o[t]=[];else e("Remove all listeners"),this._callbacks={};return this},r.prototype.unbind=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){return this.unbind(e)},r.prototype.bindForAll=function(e){this.bind("__all__",e)},r.prototype.unbindForAll=function(e){this.unbind("__all__",e)},r.prototype.trigger=function(t,n){var o,i,r,s,a=2,u=this._callbacks;for(e("Emit event %s with data %j",t,n);a--;)if(o=u[a?t:"__all__"])for(r=0,s=o.length;r<s;r++)if(i=o[r]){for(var l=[],c=a?1:0;c<arguments.length;c++)l.push(arguments[c]);i.apply(this,l)}else o.splice(r,1),r--,s--;return this},r.prototype.emit=r.prototype.trigger,r.prototype.fire=r.prototype.trigger,r.prototype.once=function(e,t){var n=this,o=function(){t.apply(n,arguments),n.unbind(e,o)};return this.bind(e,o),this};var s=void 0!==o&&o||void 0!==i&&i.nextTick||function(e){setTimeout(e,0)};r.prototype.emitLater=function(){var e=this,t=arguments;s(function(){e.trigger.apply(e,t)})},r.prototype.immediate=function(e,t,n){return this.bind(e,t),this.trigger(e,n),this},r.prototype.asap=r.prototype.immediate;var a=function(n,o,i,r){var s=this,a=arguments.length,u=0,l={};if(a<3)return this;var c=t.call(arguments,0,-2),h=arguments[a-2],p=arguments[a-1];if("function"!=typeof h)return this;e("Assign listener for events %j, once is %s",c,!!p);for(var d=function(e){s[p?"once":"bind"](e,function(t){s._fired[e]=s._fired[e]||{},s._fired[e].data=t,l[e]||(l[e]=!0,u++)})},f=c.length,g=0;g<f;g++)d(c[g]);var m=function(t){if(!(u<f)&&l[t]){for(var n=[],o=0;o<f;o++)n.push(s._fired[c[o]].data);p&&s.unbindForAll(m),e("Events %j all emited with data %j",c,n),h.apply(null,n)}};s.bindForAll(m)};return r.prototype.all=function(e,t,o){var i=n.apply([],arguments);return i.push(!0),a.apply(this,i),this},r.prototype.assign=r.prototype.all,r.prototype.fail=function(e){var t=this;return t.once("error",function(){t.unbind(),e.apply(null,arguments)}),this},r.prototype.throw=function(){this.emit.apply(this,["error"].concat(t.call(arguments)))},r.prototype.tail=function(){var e=n.apply([],arguments);return e.push(!1),a.apply(this,e),this},r.prototype.assignAll=r.prototype.tail,r.prototype.assignAlways=r.prototype.tail,r.prototype.after=function(t,n,o){if(0===n)return o.call(null,[]),this;var i=this,r=[];this._after=this._after||{};var s=t+"_group";this._after[s]={index:0,results:[]},e("After emit %s times, event %s's listenner will execute",n,t);var a=function(u,l){u===t&&(n--,r.push(l),n<1&&(e("Event %s was emit %s, and execute the listenner",t,n),i.unbindForAll(a),o.apply(null,[r]))),u===s&&(n--,i._after[s].results[l.index]=l.result,n<1&&(e("Event %s was emit %s, and execute the listenner",t,n),i.unbindForAll(a),o.call(null,i._after[s].results)))};return i.bindForAll(a),this},r.prototype.group=function(e,n){var o=this,i=e+"_group",r=o._after[i].index;return o._after[i].index++,function(e,s){if(e)return o.emit.apply(o,["error"].concat(t.call(arguments)));o.emit(i,{index:r,result:n?n.apply(null,t.call(arguments,1)):s})}},r.prototype.any=function(){var n=this,o=arguments[arguments.length-1],i=t.call(arguments,0,-1),r=i.join("_");e("Add listenner for Any of events %j emit",i),n.once(r,o);for(var s=function(t){n.bind(t,function(o){e("One of events %j emited, execute the listenner"),n.trigger(r,{data:o,eventName:t})})},a=0;a<i.length;a++)s(i[a])},r.prototype.not=function(t,n){e("Add listenner for not event %s",t),this.bindForAll(function(o,i){o!==t&&(e("listenner execute of event %s emit, but not event %s.",o,t),n(i))})},r.prototype.done=function(e,n){var o=this;return function(i,r){if(i)return o.emit.apply(o,["error"].concat(t.call(arguments)));var s=t.call(arguments,1);return"string"==typeof e?n?o.emit(e,n.apply(null,s)):o.emit.apply(o,[e].concat(s)):arguments.length<=2?e(r):void e.apply(null,s)}},r.prototype.doneLater=function(e,t){var n=this.done(e,t);return function(e,t){var o=arguments;s(function(){n.apply(null,o)})}},r.create=function(){var e=new r,t=n.apply([],arguments);if(t.length){var o=t[t.length-1],i=t[t.length-2];"function"==typeof o&&"function"==typeof i&&(t.pop(),e.fail(o)),e.assign.apply(e,t)}return e},r.EventProxy=r,r})}).call(this,n(14).setImmediate,n(3))},function(e,t,n){(function(e){var o=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(i.call(setTimeout,o,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,o,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(o,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(15),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var o,i,r,s,a,u=1,l={},c=!1,h=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?o=function(e){t.nextTick(function(){f(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){f(e.data)},o=function(e){r.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,o=function(e){var t=h.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):o=function(e){setTimeout(f,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&f(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),o=function(t){e.postMessage(s+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[u]=i,o(u),u++},p.clearImmediate=d}function d(e){delete l[e]}function f(e){if(c)setTimeout(f,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o)}}(t)}finally{d(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(4),n(3))},function(e,t,n){(function(o){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG),e}(t=e.exports=n(17)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var i=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(r=i))}),e.splice(r,0,o)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(3))},function(e,t,n){var o;function i(e){function n(){if(n.enabled){var e=n,i=+new Date,r=i-(o||i);e.diff=r,e.prev=o,e.curr=i,o=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,o){if("%%"===n)return n;u++;var i=t.formatters[o];if("function"==typeof i){var r=s[u];n=i.call(e,r),s.splice(u,1),u--}return n}),t.formatArgs.call(e,s),(n.log||t.log||console.log.bind(console)).apply(e,s)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,o=0;for(n in e)o=(o<<5)-o+e.charCodeAt(n),o|=0;return t.colors[Math.abs(o)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length,i=0;i<o;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,o;for(n=0,o=t.skips.length;n<o;n++)if(t.skips[n].test(e))return!1;for(n=0,o=t.names.length;n<o;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(18),t.names=[],t.skips=[],t.formatters={}},function(e,t){var n=1e3,o=60*n,i=60*o,r=24*i,s=365.25*r;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var u,l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*r;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*o;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===l&&!1===isNaN(e))return t.long?a(u=e,r,"day")||a(u,i,"hour")||a(u,o,"minute")||a(u,n,"second")||u+" ms":function(e){if(e>=r)return Math.round(e/r)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=o)return Math.round(e/o)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";n.r(t),n.d(t,"CLASS$",function(){return o}),n.d(t,"STATICATTR$",function(){return i}),n.d(t,"View",function(){return r}),n.d(t,"Dialog",function(){return s}),n.d(t,"GamePageUI",function(){return a}),n.d(t,"TestPageUI",function(){return u});var o=Laya.class,i=Laya.static,r=laya.ui.View,s=laya.ui.Dialog,a=function(e){function t(){this.hornScale=null,this.discRotate=null,this.bgImage=null,this.topImage=null,this.discImage=null,this.leftHornImage=null,this.rightHornImage=null,this.settings=null,this.playPause=null,this.songName=null,this.remainTime=null,this.scores=null,this.comboTarget=null,t.__super.call(this)}return o(t,"ui.pages.GamePageUI",r),t.prototype.createChildren=function(){r.regComponent("Text",laya.display.Text),laya.ui.Component.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,height:1334},child:[{type:"Image",props:{y:0,x:0,width:750,var:"bgImage",skin:"game/bg.png",height:1334}},{type:"Image",props:{var:"topImage",top:0,skin:"game/top.png",right:0,left:0,height:260}},{type:"Image",props:{y:93,x:375,width:184,var:"discImage",top:1,skin:"game/disc.png",rotation:55,pivotY:92,pivotX:92,left:283,height:175},compId:7},{type:"Image",props:{width:150,var:"leftHornImage",top:85,skin:"game/horn.png",name:"hornImage",left:20,height:142.5},compId:10},{type:"Image",props:{width:150,var:"rightHornImage",top:85,skin:"game/horn.png",right:25,name:"right",height:142.5},compId:11},{type:"Image",props:{y:158,width:60,var:"settings",skin:"game/settings.png",left:180,height:60}},{type:"Image",props:{y:159,width:50,var:"playPause",skin:"game/play_pause.png",right:180,height:50}},{type:"Text",props:{y:57,x:52,width:240,var:"songName",overflow:"scroll",height:45,fontSize:36,color:"#ffffff",align:"right"}},{type:"Text",props:{y:95,x:52,width:240,var:"remainTime",text:"--:--",height:50,fontSize:30,color:"#ffffff",align:"right"}},{type:"Text",props:{y:60,x:465,width:240,text:"Scores",fontSize:36,color:"#ffffff"}},{type:"Text",props:{y:98,x:465,width:240,var:"scores",text:"0",fontSize:30,color:"#ffffff"}},{type:"Image",props:{y:190,x:138,visible:!1,var:"comboTarget",skin:"game/touch-combo.png"}}],animations:[{nodes:[{target:10,keyframes:{width:[{value:150,tweenMethod:"linearNone",tween:!0,target:10,key:"width",index:0},{value:160,tweenMethod:"linearNone",tween:!0,target:10,key:"width",index:3},{value:150,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"width",index:10}],top:[{value:85,tweenMethod:"linearNone",tween:!1,target:10,key:"top",index:0},{value:80,tweenMethod:"linearNone",tween:!0,target:10,key:"top",index:3},{value:85,tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"top",index:10}],left:[{value:20,tweenMethod:"linearNone",tween:!1,target:10,key:"left",index:0},{value:15,tweenMethod:"linearNone",tween:!0,target:10,key:"left",index:3},{value:20,tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"left",index:10}],height:[{value:142.5,tweenMethod:"linearNone",tween:!0,target:10,key:"height",index:0},{value:152,tweenMethod:"linearNone",tween:!0,target:10,key:"height",index:3},{value:142.5,tweenMethod:"linearNone",tween:!0,target:10,label:null,key:"height",index:10}]}},{target:11,keyframes:{width:[{value:150,tweenMethod:"linearNone",tween:!0,target:11,key:"width",index:0},{value:160,tweenMethod:"linearNone",tween:!0,target:11,key:"width",index:3},{value:150,tweenMethod:"linearNone",tween:!0,target:11,key:"width",index:10}],top:[{value:85,tweenMethod:"linearNone",tween:!1,target:11,key:"top",index:0},{value:80,tweenMethod:"linearNone",tween:!0,target:11,key:"top",index:3},{value:85,tweenMethod:"linearNone",tween:!0,target:11,key:"top",index:10}],right:[{value:25,tweenMethod:"linearNone",tween:!1,target:11,key:"right",index:0},{value:20,tweenMethod:"linearNone",tween:!0,target:11,key:"right",index:3},{value:25,tweenMethod:"linearNone",tween:!0,target:11,key:"right",index:10}],height:[{value:142.5,tweenMethod:"linearNone",tween:!0,target:11,key:"height",index:0},{value:152,tweenMethod:"linearNone",tween:!0,target:11,key:"height",index:3},{value:142.5,tweenMethod:"linearNone",tween:!0,target:11,key:"height",index:10}]}}],name:"hornScale",id:1,frameRate:24,action:2},{nodes:[{target:7,keyframes:{y:[{value:93,tweenMethod:"linearNone",tween:!0,target:7,key:"y",index:0},{value:93,tweenMethod:"linearNone",tween:!0,target:7,key:"y",index:100}],x:[{value:375,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:0},{value:375,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:100}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:100}],pivotY:[{value:92,tweenMethod:"linearNone",tween:!0,target:7,key:"pivotY",index:0},{value:92,tweenMethod:"linearNone",tween:!0,target:7,key:"pivotY",index:100}],pivotX:[{value:92,tweenMethod:"linearNone",tween:!0,target:7,key:"pivotX",index:0},{value:92,tweenMethod:"linearNone",tween:!0,target:7,key:"pivotX",index:100}],height:[{value:184,tweenMethod:"linearNone",tween:!0,target:7,key:"height",index:0}]}}],name:"discRotate",id:2,frameRate:24,action:2}]},t}(),u=function(e){function t(){this.btn=null,this.clip=null,this.combobox=null,this.tab=null,this.list=null,this.btn2=null,this.check=null,this.radio=null,this.box=null,t.__super.call(this)}return o(t,"ui.test.TestPageUI",r),t.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:600,height:400},child:[{type:"Image",props:{y:0,x:0,width:600,skin:"comp/bg.png",sizeGrid:"30,4,4,4",height:400}},{type:"Button",props:{y:56,x:41,width:150,var:"btn",skin:"comp/button.png",sizeGrid:"4,4,4,4",label:"点我赋值",height:37}},{type:"Clip",props:{y:56,x:401,var:"clip",skin:"comp/clip_num.png",clipX:10}},{type:"ComboBox",props:{y:143,x:220,width:200,var:"combobox",skin:"comp/combobox.png",sizeGrid:"4,20,4,4",selectedIndex:1,labels:"select1,select2,selecte3",height:23}},{type:"Tab",props:{y:96,x:220,var:"tab",skin:"comp/tab.png",labels:"tab1,tab2,tab3"}},{type:"VScrollBar",props:{y:223,x:259,skin:"comp/vscroll.png",height:150}},{type:"VSlider",props:{y:223,x:224,skin:"comp/vslider.png",height:150}},{type:"List",props:{y:68,x:452,width:128,var:"list",vScrollBarSkin:"comp/vscroll.png",repeatX:1,height:299},child:[{type:"Box",props:{y:0,x:0,width:112,name:"render",height:30},child:[{type:"Label",props:{y:5,x:26,width:78,text:"this is a list",skin:"comp/label.png",name:"label",height:20,fontSize:14}},{type:"Clip",props:{y:2,x:0,skin:"comp/clip_num.png",name:"clip",clipX:10}}]}]},{type:"Button",props:{y:4,x:563,skin:"comp/btn_close.png",name:"close"}},{type:"Button",props:{y:112,x:41,width:150,var:"btn2",skin:"comp/button.png",sizeGrid:"4,4,4,4",labelSize:30,labelBold:!0,label:"点我赋值",height:66}},{type:"CheckBox",props:{y:188,x:220,var:"check",skin:"comp/checkbox.png",label:"checkBox1"}},{type:"RadioGroup",props:{y:61,x:220,var:"radio",skin:"comp/radiogroup.png",labels:"radio1,radio2,radio3"}},{type:"Panel",props:{y:223,x:299,width:127,vScrollBarSkin:"comp/vscroll.png",height:150},child:[{type:"Image",props:{skin:"comp/image.png"}}]},{type:"CheckBox",props:{y:188,x:326,skin:"comp/checkbox.png",labelColors:"#ff0000",label:"checkBox2"}},{type:"Box",props:{y:197,x:41,var:"box"},child:[{type:"ProgressBar",props:{y:70,width:150,skin:"comp/progress.png",sizeGrid:"4,4,4,4",name:"progress",height:14}},{type:"Label",props:{y:103,width:137,text:"This is a Label",skin:"comp/label.png",name:"label",height:26,fontSize:20}},{type:"TextInput",props:{y:148,width:150,text:"textinput",skin:"comp/textinput.png",name:"input"}},{type:"HSlider",props:{width:150,skin:"comp/hslider.png",name:"slider"}},{type:"HScrollBar",props:{y:34,width:150,skin:"comp/hscroll.png",name:"scroll"}}]},{type:"Curves",props:{y:666,x:125,points:"27.857142857142854,83.79464285714289,60.65178571428571,118.66071428571433,144.3660714285714,133.19642857142878,229.77678571428572,126.48214285714289,263.9017857142857,92.31250000000011",lineWidth:50,lineColor:"#ff0000"}},{type:"Image",props:{y:530,x:77,skin:"game/touch-hold-move-area-arc.png"}}]},t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});for(var o=n(0),i=o.TouchButtonTypeEnum.CLICK,r=o.TouchButtonTypeEnum.HOLD,s=o.TouchButtonTypeEnum.HOLD_MOVE,a=[{type:i,x:40,y:100,appearDuration:100,showDuration:6e4,baseScore:10,id:1},{type:r,x:140,y:200,appearDuration:200,showDuration:6e4,baseScore:20,id:2},{type:s,x:240,y:300,appearDuration:400,showDuration:6e4,subType:o.TouchButtonSubTypeEnum.ARC,baseScore:30,id:3},{type:s,x:240,y:400,appearDuration:600,showDuration:6e4,subType:o.TouchButtonSubTypeEnum.LIGHTNING,baseScore:40,id:4}],u=function(e,t,n){var o=JSON.parse(JSON.stringify(e[t]));return o.appearDuration+=1e3*n,o.id=a.length,o},l=1;l<=10;l++)a.push(u(a,0,l)),a.push(u(a,1,l)),a.push(u(a,2,l)),a.push(u(a,3,l));var c={buttons:a,songName:"annie's wonderland",bgm:"songs/annie_wonderland.mp3",seconds:60};t.default=c},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=Laya.Box,s=Laya.Sprite,a=function(e){function t(t,n){void 0===n&&(n=.35);var o=e.call(this)||this;return o.images=[],o.x=0,o.y=Laya.stage.height-40,o.height=40,o.numbers=t,o.imageScale=n,o.drawHeart(),Laya.timer.loop(200,o,o.setPosition),o}return i(t,e),t.prototype.drawHeart=function(){for(var e=0;e<this.numbers;e++){var t=new s,n=Laya.loader.getRes("game/heart-"+(1+e%3)+".png");t.graphics.drawTexture(n,0,-30,165*this.imageScale,151*this.imageScale),this.addChild(t),this.images.push(t)}},t.prototype.random=function(e){var t=Math.floor(Math.random()*this.numbers);return-1===e.indexOf(t)?t:this.random(e)},t.prototype.setPosition=function(){var e=this,t=(Laya.stage.width-40)/this.numbers,n=[];this.images.forEach(function(o){var i=e.random(n);n.push(i),o.pos(20+t*i,0)})},t}(r);t.default=a},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=Laya.Box,a=n(23),u=Laya.Sprite,l=n(0),c=n(2),h=function(e,t,n,o){var i=new u;i.loadImage(t),e.addChild(i),i.pos(n,o)},p="score_change",d=function(){function e(){this.combo=0,this.ep=new r.EventProxy,this.score=0,this.missNumbers=0,this.goodNumbers=0,this.perfectNumbers=0,this.comboForDoubleTime=0,this.isDoubleTime=!1,this.isTripleTime=!1,this.canBuildTripleTime=!0,this.hitResults=[]}return e.prototype.miss=function(){this.missNumbers++,this.combo=0,this.comboForDoubleTime=0,this.canBuildTripleTime=!1,this.hitResults.push(l.TouchButtonResultEventEnum.MISS),this.plusScore(0)},e.prototype.good=function(e){this.goodNumbers++,this.combo++,this.canBuildTripleTime=!1,this.hitResults.push(l.TouchButtonResultEventEnum.GOOD),this.plusScore(e),this.plusCombo()},e.prototype.perfect=function(e){this.perfectNumbers++,this.combo++,this.hitResults.push(l.TouchButtonResultEventEnum.PERFECT),this.plusScore(e),this.plusCombo()},e.prototype.plusCombo=function(){this.comboForDoubleTime++,this.comboForDoubleTime>=c.COMBO_TIMES_BUILD_DOUBLE&&!this.isDoubleTime&&!this.isTripleTime&&(console.log("触发double time",this.comboForDoubleTime),this.ep.trigger("double_time_start"),this.isDoubleTime=!0,Laya.timer.once(c.DOUBLE_TIME_LAST_SECOND,this,this.doubleTimeEnd))},e.prototype.doubleTimeEnd=function(){console.log("double time结束"),this.ep.trigger("double_time_end"),this.comboForDoubleTime=0,this.isDoubleTime=!1,this.canBuildTripleTime?(this.isTripleTime=!0,this.ep.trigger("triple_time_start"),Laya.timer.once(c.TRIPLE_TIME_LAST_SECOND,this,this.tripleTimeEnd)):this.canBuildTripleTime=!0},e.prototype.tripleTimeEnd=function(){this.comboForDoubleTime=0,this.canBuildTripleTime?this.doubleTimeEnd():(this.isTripleTime=!1,this.canBuildTripleTime=!0,this.ep.trigger("triple_time_end"))},e.prototype.plusScore=function(e){this.isDoubleTime?(e*=2,console.log("double time",e)):this.isTripleTime?(e*=3,console.log("triple time",e)):console.log("single time",e),this.score+=e,this.ep.trigger(p)},e}(),f=function(e){function t(t){var n=e.call(this)||this;return n.currentTime=0,n.buttonConfigs=[],n.createButtonDelay=1,n.buttons=[],n.ep=new r.EventProxy,n.scoreCalculator=new d,n.continuityHitResults=[],n.left=20,n.right=20,n.top=250,n.bottom=40,n.buttonConfigs=t,Laya.timer.loop(n.createButtonDelay,n,n.createButton),n.scoreCalculator.ep.on(p,function(){n.ep.trigger(p)}),n}return i(t,e),t.prototype.createButton=function(){var e=this;this.currentTime+=this.createButtonDelay;var t=this.currentTime,n=this.buttonConfigs.filter(function(e){return e.appearDuration===t});0!==n.length&&n.forEach(function(t){var n=a.createTouchButton(t);e.buttons.push(n),e.addChild(n),n.onMiss(function(){h(n,"game/touch-miss.png",-40,-10),e.scoreCalculator.miss()}),n.onGood(function(){h(n,"game/touch-good.png",-90,-60),e.scoreCalculator.good(t.baseScore)}),n.onPerfect(function(){e.scoreCalculator.perfect(t.baseScore),h(n,"game/touch-perfect.png",-90,-60)})})},t.prototype.onScoreChange=function(e){var t=this;this.ep.on(p,function(){e&&e(t.scoreCalculator.score,t.scoreCalculator.combo)})},t}(s);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=n(0),r=n(25),s=n(26),a=i.TouchButtonTypeEnum.CLICK,u=i.TouchButtonTypeEnum.HOLD,l=i.TouchButtonTypeEnum.HOLD_MOVE;t.createTouchButton=function(e){var t=e.type;return t===a?new o.ClickTouchButton(e):t===u?new r.HoldTouchButton(e):t===l?new s.HoldAndMoveTouchButton(e):null}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=Laya.Sprite,a=Laya.Box,u=n(0),l=n(2),c=function(e){function t(t,n){var o=e.call(this)||this;return o.CLICK_BUTTON_OUTSIDE_IMAGE="game/touch-click.png",o.CLICK_BUTTON_IMAGE="game/touch-click-button.png",o.CLICK_BUTTON_ACTIVE_IMAGE="game/touch-click-active.png",o.CLICK_BUTTON_WIDTH=132,o.CLICK_BUTTON_HEIGHT=127,o.ep=new r.EventProxy,o.scaleOffset=-l.SCALE_OFFSET,o.config=t,o.x=o.config.x,o.y=o.config.y,o.currentScale=l.ANIMATE_AREA_MAX,o.draw(),o.start(),o.ep.on(u.TouchButtonResultEventEnum.MISS,function(){o.hide(),o.clickButton.visible=!1}),o}return i(t,e),t.prototype.draw=function(){this.animateArea=new s,this.addChild(this.animateArea),this.clickButton=new s,this.addChild(this.clickButton),this.clickButton.loadImage(this.CLICK_BUTTON_IMAGE,0,0,this.CLICK_BUTTON_WIDTH,this.CLICK_BUTTON_HEIGHT),this.clickButton.on(laya.events.Event.CLICK,this,this.onButtonClick)},t.prototype.start=function(){Laya.timer.once(this.config.showDuration,this,this.autoDisappear),Laya.timer.loop(l.SCALE_INTERVAL,this,this.play)},t.prototype.play=function(){if(this.currentScale+=this.scaleOffset,this.currentScale>=l.ANIMATE_AREA_MAX||this.currentScale<=l.ANIMATE_AREA_MIN)return this.scaleOffset=-this.scaleOffset,this.ep.trigger(u.TouchButtonResultEventEnum.MISS);var e=this.CLICK_BUTTON_HEIGHT,t=this.CLICK_BUTTON_WIDTH;this.animateArea.graphics.clear();var n=t*this.currentScale,o=e*this.currentScale;this.animateArea.loadImage(this.CLICK_BUTTON_OUTSIDE_IMAGE,-(n-t)/2,-(o-e)/2,n,o)},t.prototype.autoDisappear=function(){console.log("autoDisappear","miss"),this.ep.trigger(u.TouchButtonResultEventEnum.MISS)},t.prototype.onGood=function(e){this.ep.once(u.TouchButtonResultEventEnum.GOOD,e)},t.prototype.onMiss=function(e){this.ep.once(u.TouchButtonResultEventEnum.MISS,e)},t.prototype.onPerfect=function(e){this.ep.once(u.TouchButtonResultEventEnum.PERFECT,e)},t.prototype.hide=function(e){void 0===e&&(e=!1),Laya.timer.clear(this,this.autoDisappear),Laya.timer.clear(this,this.play),this.animateArea.destroy(),e&&this.clickButton.destroy(),Laya.timer.once(300,this,this.remove)},t.prototype.remove=function(){this.destroy(!0)},t.prototype.onButtonClick=function(){var e=this;this.hide(!1),this.clickButton.graphics.clear(),this.clickButton.loadImage(this.CLICK_BUTTON_ACTIVE_IMAGE,0,0,this.CLICK_BUTTON_WIDTH,this.CLICK_BUTTON_HEIGHT),Laya.timer.once(70,null,function(){e.clickButton.destroy()}),(this.currentScale-l.ANIMATE_AREA_MIN)/(l.ANIMATE_AREA_MAX-l.ANIMATE_AREA_MIN)<=l.SCALE_PERCENT_PERFECT?this.ep.trigger(u.TouchButtonResultEventEnum.PERFECT):this.ep.trigger(u.TouchButtonResultEventEnum.GOOD)},t}(a);t.ClickTouchButton=c},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=Laya.Box,a=Laya.Sprite,u=n(0),l=Laya.GlowFilter,c=n(2),h="finish",p=function(e){function t(t,n){var o=e.call(this)||this;return o.HOLD_BUTTON_IMAGE="game/touch-hold-button.png",o.HOLD_BUTTON_OUTSIDE_IMAGE="game/touch-hold.png",o.HOLD_PROGRESS_IMAGE="game/touch-hold-progress-empty.png",o.HOLD_BUTTON_WIDTH=132,o.HOLD_BUTTON_HEIGHT=127,o.ep=new r.EventProxy,o.scaleOffset=-c.SCALE_OFFSET,o.progress=null,o.progressInside=null,o.progressPercent=0,o.config=t,o.x=o.config.x,o.y=o.config.y,o.currentScale=c.ANIMATE_AREA_MAX,o.draw(),o.start(),o.ep.on(u.TouchButtonResultEventEnum.MISS,function(){o.ep.unbind(h),o.hide(),o.holdButton.visible=!1}),o.ep.once(h,o.finish.bind(o)),o}return i(t,e),t.prototype.draw=function(){this.holdButton=new a,this.addChild(this.holdButton),this.holdButton.loadImage(this.HOLD_BUTTON_IMAGE),this.animateArea=new a,this.addChild(this.animateArea),this.holdButton.on(laya.events.Event.MOUSE_DOWN,this,this.onMouseDown),this.holdButton.on(laya.events.Event.MOUSE_MOVE,this,this.onMouseMove),this.holdButton.on(laya.events.Event.MOUSE_UP,this,this.onMouseUp)},t.prototype.start=function(){Laya.timer.loop(c.SCALE_INTERVAL,this,this.play)},t.prototype.play=function(){if(this.currentScale+=this.scaleOffset,this.currentScale>=c.ANIMATE_AREA_MAX||this.currentScale<=c.ANIMATE_AREA_MIN)return this.scaleOffset=-this.scaleOffset,this.ep.trigger(u.TouchButtonResultEventEnum.MISS);var e=this.HOLD_BUTTON_HEIGHT,t=this.HOLD_BUTTON_WIDTH;this.animateArea.graphics.clear();var n=t*this.currentScale,o=e*this.currentScale;this.animateArea.loadImage(this.HOLD_BUTTON_OUTSIDE_IMAGE,-(n-t)/2,-(o-e)/2,n,o)},t.prototype.onMouseDown=function(){null===this.progress&&(this.progress=new a,Laya.timer.clear(this,this.play),this.animateArea.destroy(),this.addChild(this.progress),this.progress.loadImage(this.HOLD_PROGRESS_IMAGE),this.progress.pos(-19,-250),this.progressInside=new a,this.progress.addChild(this.progressInside),this.progressInside.filters=[new l("#fae3ef",10,0,0)],Laya.timer.loop(100,this,this.fillProgress))},t.prototype.onMouseMove=function(){},t.prototype.onMouseUp=function(){Laya.timer.clear(this,this.fillProgress),this.ep.trigger(h)},t.prototype.fillProgress=function(){this.progressPercent+=5,this.progressPercent>=100&&(this.progressPercent=100);var e=this.progressPercent<=10?10:this.progressPercent;this.progressInside.graphics.clear();var t=67,n=[["moveTo",84,t=256-(256-t)/100*e],["moveTo",48,t],["arcTo",103.5,t,103.5,t+18,18],["lineTo",103.5,238],["arcTo",103.5,256,85.5,256,18],["lineTo",84,256],["arcTo",66,256,66,238,18],["lineTo",66,t+18],["arcTo",66,t,84,t,18],["closePath"]];if(this.progressInside.graphics.drawPath(0,0,n,{fillStyle:"#fae3ef"}),100===this.progressPercent)return this.ep.trigger(h),Laya.timer.clear(this,this.fillProgress)},t.prototype.onGood=function(e){this.ep.once(u.TouchButtonResultEventEnum.GOOD,e)},t.prototype.onMiss=function(e){this.ep.once(u.TouchButtonResultEventEnum.MISS,e)},t.prototype.onPerfect=function(e){this.ep.once(u.TouchButtonResultEventEnum.PERFECT,e)},t.prototype.hide=function(){Laya.timer.clear(this,this.play),this.animateArea&&this.animateArea.destroy(),this.progressInside&&this.progressInside.destroy(),this.progress&&this.progress.destroy(),this.holdButton&&this.holdButton.destroy(),Laya.timer.once(300,this,this.remove)},t.prototype.remove=function(){this.destroy(!0)},t.prototype.finish=function(){this.hide(),(this.currentScale-c.ANIMATE_AREA_MIN)/(c.ANIMATE_AREA_MAX-c.ANIMATE_AREA_MIN)<=c.SCALE_PERCENT_PERFECT&&100-this.progressPercent<=100*c.SCALE_PERCENT_PERFECT?this.ep.trigger(u.TouchButtonResultEventEnum.PERFECT):this.ep.trigger(u.TouchButtonResultEventEnum.GOOD)},t}(s);t.HoldTouchButton=p},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),a=n(0),u=Laya.Sprite,l=Laya.Box,c=a.TouchButtonSubTypeEnum.ARC,h=a.TouchButtonSubTypeEnum.LIGHTNING,p="finished",d=function(e){function t(t,n){var o=e.call(this)||this;return o.TOUCH_MOVE_OUTSIDE_IMAGE="game/touch-hold-move.png",o.TOUCH_MOVE_BUTTON_IMAGE="game/touch-hold-move-button.png",o.TOUCH_MOVE_AREA_ARC_IMAGE="game/touch-hold-move-area-arc.png",o.TOUCH_MOVE_AREA_ARC_FILL_IMAGE="game/touch-hold-move-area-arc-fill.png",o.TOUCH_MOVE_AREA_LIGHTNING_IMAGE="game/touch-hold-move-area-lightning.png",o.TOUCH_MOVE_AREA_LIGHTNING_FILL_IMAGE="game/touch-hold-move-area-lightning-fill.png",o.HOLD_BUTTON_WIDTH=132,o.HOLD_BUTTON_HEIGHT=127,o.ep=new r.EventProxy,o.scaleOffset=-s.SCALE_OFFSET,o.currentStage=1,o.config=t,o.x=o.config.x,o.y=o.config.y,o.currentScale=s.ANIMATE_AREA_MAX,o.draw(),o.start(),o.ep.once(a.TouchButtonResultEventEnum.MISS,function(){o.hide(),o.holdButton.visible=!1}),o.ep.once(p,o.onFinish.bind(o)),o}return i(t,e),t.prototype.draw=function(){this.slideArea=new u,this.addChild(this.slideArea),this.animateArea=new u,this.addChild(this.animateArea),this.slideAreaShow=new u,this.slideAreaShow.visible=!1,this.slideArea.addChild(this.slideAreaShow),this.holdButton=new u,this.addChild(this.holdButton),this.holdButton.pos(0,0),this.config.subType===c?(this.slideAreaShow.loadImage(this.TOUCH_MOVE_AREA_ARC_FILL_IMAGE),this.holdButton.loadImage(this.TOUCH_MOVE_BUTTON_IMAGE,0,32,this.HOLD_BUTTON_WIDTH,this.HOLD_BUTTON_HEIGHT),this.animateArea.pos(0,32),this.slideArea.loadImage(this.TOUCH_MOVE_AREA_ARC_IMAGE)):this.config.subType===h&&(this.holdButton.loadImage(this.TOUCH_MOVE_BUTTON_IMAGE,0,0,this.HOLD_BUTTON_WIDTH,this.HOLD_BUTTON_HEIGHT),this.slideArea.loadImage(this.TOUCH_MOVE_AREA_LIGHTNING_IMAGE),this.slideAreaShow.loadImage(this.TOUCH_MOVE_AREA_LIGHTNING_FILL_IMAGE),this.slideArea.pos(-137,10)),this.slideArea.on(laya.events.Event.MOUSE_DOWN,this,this.onMouseDown),this.slideArea.on(laya.events.Event.MOUSE_MOVE,this,this.onMouseMove),this.slideArea.on(laya.events.Event.MOUSE_UP,this,this.onMouseUp)},t.prototype.start=function(){Laya.timer.once(this.config.showDuration,this,this.autoDisappear),Laya.timer.loop(s.SCALE_INTERVAL,this,this.play)},t.prototype.hide=function(){Laya.timer.clear(this,this.autoDisappear),Laya.timer.clear(this,this.play);try{this.animateArea.visible=!1,this.slideArea.visible=!1,this.holdButton.visible=!1,this.slideAreaShow.visible=!1,this.slideAreaShowMask.visible=!1}catch(e){}Laya.timer.once(300,this,this.remove)},t.prototype.play=function(){if(this.currentScale+=this.scaleOffset,this.currentScale>=s.ANIMATE_AREA_MAX||this.currentScale<=s.ANIMATE_AREA_MIN)return this.scaleOffset=-this.scaleOffset,this.ep.trigger(a.TouchButtonResultEventEnum.MISS);var e=this.HOLD_BUTTON_HEIGHT,t=this.HOLD_BUTTON_WIDTH;this.animateArea.graphics.clear();var n=t*this.currentScale,o=e*this.currentScale;this.animateArea.loadImage(this.TOUCH_MOVE_OUTSIDE_IMAGE,-(n-t)/2,-(o-e)/2,n,o)},t.prototype.autoDisappear=function(){this.ep.trigger(a.TouchButtonResultEventEnum.MISS)},t.prototype.onMouseDown=function(){Laya.timer.clear(this,this.play),this.animateArea.destroy()},t.prototype.onMouseMove=function(e){var t,n,o,i,r=e.stageX,s=e.stageY;if(Laya.timer.clear(this,this.autoFinish),Laya.timer.once(500,this,this.autoFinish),!1===this.slideAreaShow.visible&&(this.slideAreaShow.visible=!0,this.slideAreaShowMask=new u,this.slideAreaShow.mask=this.slideAreaShowMask),this.slideAreaShowMask.graphics.clear(),this.config.subType===c){o=(t=this.fixArc(r,s))[0],i=t[1],this.progressPercent=Math.min((o+1.8)/189.8,1);var a=Math.min(160-140*this.progressPercent,160);this.slideAreaShowMask.graphics.drawPie(160,0,180,a,160,"#fff")}else if(this.config.subType===h){o=(n=this.fixLightning(r,s))[0],i=n[1];var l=null;1===this.currentStage?(l=[["moveTo",-100,-100],["lineTo",36,36],["lineTo",o+18,i+54],["lineTo",o-18-100,i+18-100]],this.slideAreaShowMask.graphics.drawPath(205,16,l,{fillStyle:"#ff0000"})):2===this.currentStage?l=[["moveTo",-42,116],["lineTo",36,36],["lineTo",0,0],["lineTo",-170,170],["lineTo",o,170],["lineTo",Math.max(o,-42),116]]:3===this.currentStage&&(l=[["moveTo",-205,-16],["lineTo",-205,Math.max(i+36,170)],["lineTo",2e3,Math.max(i+36,170)],["lineTo",2e3,-16]]),l&&this.slideAreaShowMask.graphics.drawPath(205,16,l,{fillStyle:"#ff0000"})}this.holdButton.pos(o,i),this.progressPercent>=1&&(Laya.timer.clear(this,this.autoFinish),this.ep.trigger(p))},t.prototype.fixArc=function(e,t){e=e-this.x-20-40,t=t-this.y-250-40,e=Math.max(e,0),t=Math.max(t,0),t=Math.min(t,37);if(92-(e=Math.min(e,190))==0)return[92,35];var n=(-120-t)/(92-e),o=-120-92*n,i=n*n+1,r=2*n*o-2*n*-120-184,s=8464+(o- -120)*(o- -120)-24025,a=(Math.sqrt(r*r-4*i*s)-r)/(2*i),u=n*a+o;if(!(a>=0&&u>=0)){var l=(-Math.sqrt(r*r-4*i*s)-r)/(2*i),c=n*l+o;l<0&&c<0||(u=c,a=l)}return[a,u]},t.prototype.fixLightning=function(e,t){e=e-this.x-20-80+10,t=t-this.y-250-80+15,t=Math.min(t,220),t=Math.max(t,0),e=Math.min(e,10),e=Math.max(e,-100),t<90&&1===this.currentStage||(t>=90&&t<=105&&1===this.currentStage?this.currentStage=2:t>110&&e>=0&&2==this.currentStage&&(this.currentStage=3));var n=e;return 1==this.currentStage?(n=t/-1,t=Math.min(t,105),this.progressPercent=.33333333*t/105):3==this.currentStage?(n=t/-1+120,t=Math.max(t,110),this.progressPercent=.33333333*(2+(t-105)/111)):2==this.currentStage&&(t=105,n=e,this.progressPercent=.33333333*(1+(n+95)/105)),this.progressPercent=Math.min(this.progressPercent,1),[n,t]},t.prototype.autoFinish=function(){this.ep.trigger(p)},t.prototype.onMouseUp=function(){this.ep.trigger(p)},t.prototype.onGood=function(e){this.ep.once(a.TouchButtonResultEventEnum.GOOD,e)},t.prototype.onMiss=function(e){this.ep.once(a.TouchButtonResultEventEnum.MISS,e)},t.prototype.onPerfect=function(e){this.ep.once(a.TouchButtonResultEventEnum.PERFECT,e)},t.prototype.remove=function(){this.destroy(!0)},t.prototype.onFinish=function(){this.hide(),(this.currentScale-s.ANIMATE_AREA_MIN)/(s.ANIMATE_AREA_MAX-s.ANIMATE_AREA_MIN)<=s.SCALE_PERCENT_PERFECT&&1-this.progressPercent<=s.SCALE_PERCENT_PERFECT?this.ep.trigger(a.TouchButtonResultEventEnum.PERFECT):this.ep.trigger(a.TouchButtonResultEventEnum.GOOD)},t}(l);t.HoldAndMoveTouchButton=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomNumber=function(e,t){return Math.random()*(t-e)+e},t.formatTime=function(e){if(e<60)return"00:"+e;var t=Math.floor(e/60);t<10&&(t="0"+t);var n=e%60;return n<10&&(n="0"+n),t+":"+n}}]);